# 条件分岐とコードブロック

{{ TOC }}

## 概要

条件分岐は「ある条件Aを満たす場合にBをする」といったかたちで、
特定の条件に応じてプログラムの動きを変えるためのPythonの文法です。

条件分岐にはif/elif/elseの構文を使い、それぞれ「条件を満たすなら処理をする」
「それより上の条件分岐を満たしておらず、この条件を満たすなら処理をする」
「どの条件も満たさなければ処理をする」という役割を持ちます。
if文は必須ですが、elifとelseは必ずしも必要ありません。
そしてelifは好きなだけ使えますが、ifとelseは1つまでです。

プログラムの実行グループはコードブロックと呼ばれており、
Pythonはそれをインデントで記します。
C言語やJavaのように中括弧「{}」でコードブロックを書くのではなく、
インデントを強制しているため見た目が綺麗になるという特徴があります。

## 条件分岐

プログラムの基本的な流れは上から下へ一行ずつ実行していくというものです。
単純なプログラムですと、プログラムファイルに実施する処理を順番に羅列するだけで実現できます。
ただ、少し複雑なプログラムになると「上から下に順番に実行していく」というだけでは処理を実現できません。

たとえば、天気予報を確認するアプリを考えてみます。
「今日が晴れなら晴れマークを表示、雨なら雨マークを表示」といった具合に
「あるものがAならBをする。そうでないならCをする」という「条件」に応じて処理が「分岐」します。
こういった処理のことを「*条件分岐*」と呼び、多くのプログラミング言語でサポートされます。

条件分岐は、条件分岐の式を満たすか満たさないかで実行される処理が変わるという制御構造です。
Bool型の値が条件判定に利用され、それがTrueなら処理Aをし、Falseなら処理Bをするといった形で、
条件により実行するプログラムが変わります。

## if文

Pythonだけでなく多くのプログラミング言語は条件分岐を「*if文*」で実現します。
if文のあとに「*条件式*」を書き、その条件式が満たされる場合にif文の処理が実行されます。

条件式は「Bool型の値」として判定されるコードで、
一般的には「Bool値を持つ変数」や「比較演算子を使った式」が使われます。
文法としては以下のように使います。

```text
if 条件式:
  条件式がTrueの時に実行される処理
```

ifのあとに条件式を書き、それに続けてコロン「:」を書きます。
そのあとで改行及びインデント(字下げ)をし、条件式がTrueになる場合に実行される処理を書きます。

実際のPythonのプログラムですと以下のようになります。

```python
a = 5
if 10 > a:
  print('True: 10 > a')
```

```text
True: 10 > a

```

上記の「10 > a」が条件式で、これがTrueとなればif文の次の行の処理が実行されます。
aには5が代入されているため、「10 > 5」はTrueとなり、その次のprint文が実行されています。

aに代入する値を100に変えて、再度プログラムを実行してみます。

```python
a = 100
if 10 > a:
  print('True: 10 > a')
```

```text


```

今度は「10 > a」のaに100が代入されているため、条件式はFalseとなります。
そのため、if文の次の行(条件式がTrueの場合だけ実行される)が実行されず、print文の出力がありません。

## コードブロック

先ほどの例ではif文が条件を満たす場合の処理を細かい説明なしに1行だけとしました。
ただ、複雑なプログラムではif文の処理も複雑になるため複数行の処理を実行する必要がでてきます。

その際にif文が「どこからどこまでをカバーしているか」をプログラムに教えてあげる必要があります。
プログラミングでは条件分岐といったある特定の処理の「対象範囲」を「*コードブロック*」で示します。

Pythonではコードブロックを「*インデント(字下げ)*」を揃えることで実現しています。
具体的には以下のようなものです。

```text
処理1
if 条件式:
   # ここから
   処理2
   処理3
   # ここまでがコードブロック
処理4
```

上記の例ではif文の後にif文のコードブロックが続き、
どこからどこまでが対象になるかをインデントで示しています。
処理2と処理3は同じインデントレベル(深さ)で字下げされているので、同じコードブロックに属しています。

Pythonのインデントの仕方は「半角空白を4つ」が標準で、それに次いで半角空白2つも一般的です。
タブでインデントをすることは推奨されておりませんが使えます。
ただ、半角空白とタブを併用したインデントは避けて下さい。

具体例としては以下のようなものになります。

```python
a = 5
print(1)
if 10 > a:
  print(2)
  print(3)
print(4)
```

```text
1
2
3
4
```

変数aに5が代入されているため、条件分岐で「10 > a」が満たされます。
そのためif文に属さない「print(1)」に続いて、if文の処理である「print(2)」と「print(3)」が実行されます。
その後にある「print(4)」はif文のコードブロック外なので、if文の条件式に関わらず実行されます。

aに代入する値を100に変えて、条件式がFalseになる状態でプログラムを再度実行してみます。

```python
a = 100
print(1)
if 10 > a:
  print(2)
  print(3)
print(4)
```

```text
1
4
```

if文のコードブロックに属する「print(2)」と「print(3)」が実行されなくなりましたが、
コードブロックの範囲外である「print(1)」と「print(4)」は実行されています。

## コードブロックのネスト

コードブロックの中にコードブロックを作ることも可能です。
たとえばif文による条件分岐の中に、さらにif文の条件分岐を作るといった具合です。
コードブロックに限らず、プログラミングで「入れ子」構造にすることを一般的に「*ネスト*」すると言います。

Pythonはコードブロックをインデントレベル(深さ)で示しますので、
コードブロックの中のコードブロックはインデントレベルが1つ深くなります。
具体的には以下のようになります。

```text
if 条件式A:
  処理1
  if 条件式B:
    処理2
  処理3
```

条件式Bを持つif文のコードブロックは、条件式Aのif文のコードブロックの中にあります。
コードブロックの中のコードブロックに属する処理2はインデントレベルが一つ下がっています。

実際のコードでは以下のようになります。

```python
a = 5
b = 5
print(1)
if 10 > a:
  print(2)
  if 10 > b:
    print(3)
  print(4)
print(5)
```

変数の値を変更した際に、プログラムがどのように動くかを以下に図で記載します。

<<図>>

「print(2)」「print(3)」「print(4)」はすべて「if 10 > a:」のコードブロックに属しています。
ただ、「print(3)」はそれに加えて「if 10 > b:」のコードブロックにも属しています。

内側のコードブロックは外側のコードブロックが実行される場合のみ実行されます。
そのため、たとえ「if 10 > b:」がTrueになったとしても、
「if 10 > a:」がFalseになる場合は判定すらされませんので処理は実行されません。

コードブロックのネストは深くなるとプログラムが読みにくくなります。
深いレベルのネストが必要な状況になってきたら、
アルゴリズムそのものを見直すか後のページで扱う「関数」に処理を分割するなどして、
ネストのレベルを下げるようにしてください。

## else文

## elif

## pass




以下に条件分岐の仕組みを図で記します。

![image](./0040_image/01.jpg)

上記の図のうち、「if」は必ず必要です。そして「elif」は任意の数(0も含む)繰り返すことができ、
「else」も省略することができます。if や elif、else にはそれぞれ決まった処理が書かれます。
条件が合致した処理のみが実行され、他の条件に結びついた処理は一切実行されません。
elseがないときは、どの条件にも合致しない場合は「何もしない」という動きになります。

この図をPythonのプログラムで書くと以下のようになります。

```
if(条件A):
  処理1  # 条件 A が True の時に実行される処理
elif(条件B):
  処理2  # 条件 A が False で条件 B が True の時に実行される処理
elif(条件C):
  処理3  # 条件 A,B が False で条件 C が True の時に実行される処理
else:
  処理4  # 全ての条件が False の時に実行される処理
```

上記のifからelseの次の行までがひとつの「if文のカバー範囲」であり、
そのなかにあるifやelif、elseが細かい処理の単位だと思っていただければ大丈夫です。
条件ごとの処理はインデント(字下げ)されていることが分かります。

実際に条件分岐を行うプログラムを書くことで、条件分岐の使い方をイメージしてみましょう。
プログラムは非常に簡単で、変数xの値が0より大きければ「+」と出力し、
ピッタリ0なら「0」、0未満なら「-」と出力するというものです。
これは以下のようになります。

```python
x = 5
if(x > 0):
  print('+')
elif(x == 0):
  print('0')
else:
  print('-')

# +
```

上記プログラムをIDLEのエディタに書いて実行してみてください。
xに5が代入されているので、「+」と出力されたはずです。これはx > 0の条件式が満たされ(Trueとなり)、
「print('+')」が実行されたからです。そして if else の条件文をぬけるため、
print(‘0’) や print(‘-‘) は実行されません。
このxに代入する値をいろいろ変えて動かしてみると、どの条件式がチェックされ、
「if、elif、else」のどの処理が実行されたのかイメージできるはずです。

## インデントとコードブロック

条件分岐の話が終わったので、インデント(字下げ)についてもう少し詳しくお話しましょう。
先ほどのプログラムでif文に書かれた処理はかなりシンプルなものでしたが、
実際にはif文は多くの処理を持ちます。
すると、

以下のコードを見て下さい。

```
処理1
if(条件A):
   # ここから
   処理2
   処理3
   # ここまでがコードブロック
else:
   # ここから
   処理4
   # ここまでがコードブロック
処理5
```

上記のプログラムでは処理1、2、3、4、5 があります。このうち処理1は if 文の範囲外なので常に実行されます。
そして処理2,3 は if 文のコードブロックに属するので、条件Aが満たされる場合に両方とも実行されます。
処理2,3 のインデントは同じ深さなので、同じコードブロックです。
処理4はelse の場合のみ実行され、処理5は常に実行されます。
字下げをすることでコードブロックを表現する。簡単です。

なお、CやJavaにもコードブロックはありますが、その書き方は異なっています。
たとえばJavaだと上記のサンプルコードは以下のようなものとなります。

```
処理1
if(条件A){    
  // ここから
  処理2  // 字下げは必須ではない
  処理3
　// ここまでがコードブロック
}else{
  // ここから
  処理4
　// ここまでがコードブロック    
}
処理5
```

{}で囲むことでコードブロックを表しています。
たいていは読みやすいように上記のようにインデントをしますが、
プログラムとしてはインデントをする必要性はありません。

### コードブロックのネスト



### pass文

なお、コードブロックの中には最低一つの式を書く必要があります。
そのため、if 文や関数を「とりあえず作って詳細は後で実装する」という場合に
「なにもしない」ということをブロック内に書く必要があります。
それには pass キーワードを使います。

```
a = 'hello'
if(a == 'hello'):
  # 将来ここに処理を実装
  pass
else:
  # 将来ここに処理を実装
  pass

print(a)
```

上記の pass はなにもしないためにこの if 文は不要です。
ただ、コメントにもあるように「とりあえずプログラムの構造を作っておきたい」という場合に pass 文を利用することはよくあります。
pass を書かかずにブロックに何もないとプログラムはエラーとなります。

## 3項演算子

今まで扱ってきた if 文や ループに比べてあまり利用されないため後にもってきましたが、
実は if 文の亜種の3項演算子というものも存在します。

例えば以下のプログラムがあるとしましょう。

```
a = 5

if(a % 2 == 0):
  is_even = True
else:
  is_even = False

print(is_even)
# False
```

上記プログラムは a という変数に格納されている値が偶数であれば is_even という変数に True をいれ、
そうでなければ False をいれるというものです。
プログラムを書いていると、時々こういうような if 文の結果に応じて同じ変数に入れる値が変わるという場面に出くわします。

3項演算子はまさにこういった処理をするために用意された文法で、以下のように書きます。

```python
a = 5

# (Trueのときに返る値) if (条件式) else (Falseのときに返る値)
is_even = True if (a % 2 == 0) else False

print(is_even)
# False
```

## 1ライナーの条件式

最後に1ライナーと呼ばれるテクニックを紹介します。
インデントとコードブロックで説明したように、基本的には if や for の処理は字下げして書きます。
ただ、1行だけの処理であれば条件式の直後に処理を書くことができます。

例えば以下のようなものになります。

```python
a = 5
if(a==5): print('a == 5')
else: print('a != 5')
# a == 5

for i in [1,2,3]: print(i)
# 1
# 2
# 3
```

Python の分かりやすさは綺麗なインデントにあるといっても過言ではないので、
乱用は避けたほうがいいです。
ただ、あまりにも短い単純なコードであれば1ライナーで書いてしまったほうが見やすい場合もあります。
