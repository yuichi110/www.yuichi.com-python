# Python 3 のインストールと実行

{{ TOC }}

## 概要

Pythonを使うには、そのコンピュータにPythonがインストールされている必要があります。
Pythonには「Python2」と「Python3」があり、2017年現在はPython2からPython3に主流が移る過渡期にいます。
そのため、特別な理由などがなければPython3を学ぶことが、今後のことを考えると望ましいです。

WindowsにはPython2もPython3も、デフォルトではインストールされていません。
そのため、Pythonを使うにはインストールが必要です。

MacにはPython2のみデフォルトでインストールされています。
Python3を使いたければ、Python3をインストールする必要があります。

WindowsやMacにPythonをインストールすると、Pythonが使えるようになります。
Pythonを使うにはコンソール(Windowsではパワーシェル、Macではターミナル)で、pythonコマンドを使います。
そうすることでPythonのプログラムを実行したり、対話式のシェルを使うことができます。

<!-- 図を貼ること -->

## Pythonのインストール

### Windows10へのインストール

WindowsにはデフォルトでPythonがインストールされていません。
Pythonを使うためにはインストールが必須です。

インストールにはPythonの公式サイト(https://www.python.org/)から、
実行環境にあったPythonのインストールイメージをダウンロードしてきます。

![image](./0020_image/01.png)

Pythonには現在2.xと3.xのバージョンがありますが、本書ではPython3を利用するため、
「3.X」となっている最新版をインストールしてください。

Python2とPytho3のプログラムには一部互換性がありません。
そのため、Python2で作ったコードをPython3で使うことや、
その逆ができないことが多々ありますので注意してください。

もし仮にPython2のプログラムを書く場合であっても、それがPython3で動くように書く癖をつけておいてください。
完全に互換性をもたせるのは大変なのでおすすめしませんが、
Python3で廃止される古いPython2の書き方に固執するのはよくありません。

ちなみにPython 2と3の両方をインストールして使い分けることも可能ですので、
最終的に2.xを使いたいかたも、3.xをインストールして大丈夫です。

上記ページから落としてきたイメージからインストーラーを立ち上げると以下のような画面が現れると思います。

![image](./0020_image/02.png)

この選択画面で赤の枠囲みがされている場所をチェックすると、
「環境変数」と呼ばれるアプリケーションの所在地を示す情報が Windows に自動で登録されますのでチェックをして下さい。

環境変数への登録は後ほど説明するコンソールが、そのプログラムを使うために必要です。
コンソールにたいして「ここにプログラムがあるよ」と教えてあげることで、コンソールがPythonの実行環境がどこにあるか知ることができます。

逆に言えば、環境変数に登録しないと、コンソールがPythonがどこに存在するか知らないため、
Pythonを使おうとした際に「そんなものはない」と怒られてしまいます。

仮にこの選択画面でチェックを忘れた場合は、「パスを通す」という作業をする必要があります。
Googleなどで検索してもらえればパスの通しかたは分かるはずですが、
面倒な場合はもう一度Pythonをインストールしなおして、その際に環境変数の登録をしてください。

Install Now と Customize installation の選択肢がありますが、
この Windows ユーザだけで使うのであれば Install Now で構いません。他のユーザが使ったり、
凝った使い方をしたりしたい場合は Windows のルートディレクトリ直下やProgram Filesにインストールする必要があります。

この後のインストール作業は難しくないので割愛します。

### Windows10でPythonの動作確認

さっそくインストールを終えた Python を利用してみたいと思います。
パワーシェルなりコマンドプロンプトなりをたちあげると「コンソール」が現れますので、
そこから python を使うことができます。

パワーシェル及びコマンドプロンプトは場所がわからなくてもWindows の検索機能を使うことで見つけられるかと思います。
参考のために以下に画像を記載します。

![image](./0020_image/03.png)

パワーシェルやコマンドプロンプトは何度も使うことになるので、
タスクバーにピン留めしてすぐに使えるようにしておくと今後が楽です。

プロンプトから以下のように「python --version」と打ってPythonを起動してみてください。
先ほどのインストール作業時にパスが登録されていれば、以下のような出力が得られると思います。

![image](./0020_image/04.png)

そのようなものがないと怒られた場合はインストールができていないかパスが通っていません。
パスの通し方は検索してもらえればすぐに分かるはずです。

なお、本サイトのプログラムはMacで書いて実行しているため、微妙にWindowsと食い違いが発生するかもしれません。
大きな差ですと明記しますが、コマンド名やOSのディレクトリ構造といった小さい箇所は適時読み変えて下さい。

また、「ターミナル」と言った場合はパワーシェルやコマンドプロンプトのことを指します。

### Macへのインストールと動作確認

Windowsと異なり、MacにはデフォルトでPythonがインストールされています。
ただ、インストールされているものはPython2のため、Python3はインストールが必要です。
Windowsへのインストールと同じように公式サイト(https://www.python.org/)へ行き、
Python3のイメージをダウンロードしてきてインストールを行って下さい。

MacでのPython3のインストールは非常に簡単なため、割愛します。
Windowsで行ったパスを通すなどの作業は、自動で行われるため不要です。

MacでのPythonの実行も、Windowsと同じコンソールを使います。
Macのコンソールアプリケーションはターミナル(コマンドライン)で、
それは「アプリケーション」フォルダ配下の「ユーティリティ(Utilities)」の下にあります。

ターミナルは今後頻繁に使うことになるので、ドラッグ&ドロップでDockに登録しておいたほうがよいと思います。

![image](./0020_image/05.png)

ターミナルを起動して、「python --version」と打つと、
おそらくPython2のバージョンが表示されます。

Python3のバージョンを確認するには「python3 --version」と打つ必要があります。

![image](./0020_image/06.png)

Macには複数のバージョンのPythonがインストールされています。
デフォルトのPythonはPython2であるため、「python」とだけ入力するとpython2が使われます。
python3を使うためには、「python3」と明示的にバージョンを指定する必要があります。

ちなみに、ターミナルにて「python」に続いてtabボタンを打つと、
MacにインストールされているPythonのバージョン一覧が確認できます。

#### MAC: pythonのバージョン一覧を確認

```text
$ python
python             python2.7-config   python3.5-32       pythonw2.6
python-config      python3            python3.5-config   pythonw2.7
python2.6          python3-32         python3.5m
python2.6-config   python3-config     python3.5m-config
python2.7          python3.5          pythonw
```

上記の例ではPython2として、python2.6と2.7がインストールされており、
Python3としてpython3.5がインストールされています。

Python3 を使うつもりで間違えてPython2を使ったり、
その逆が発生したりしないように注意をしてください。


## Pythonの実行

### Pythonインタプリタ

インストールが完了したので、さっそくPythonを使ってみましょう。
`--version`オプションなしで`python`と打つと、Pythonのシェルを利用できます。

#### コンソール: Pythonシェルを起動

```python
$ python3
Python 3.5.2 (v3.5.2:4def2a2901a5, Jun 26 2016, 10:47:25)
[GCC 4.2.1 (Apple Inc. build 5666) (dot 3)] on darwin
Type "help", "copyright", "credits" or "license" for more information.
>>>
```

画面に以下の「プロンプト」が表示されます。
これはPythonがユーザにプログラムの入力を求めている状態です。

#### コンソール: Pythonシェルのプロンプト

```python
>>>
```

それに続けてPythonのプログラムを書いて実行させます。
今回は簡単な計算をさせます。

#### コンソール: Pythonシェルで足し算を実行

```python
>>> 1 + 1
2
>>>
```

エンターキー(リターンキー)を押すと、入力していたプログラムをPythonが読み取り、
その結果を返します。
今回は`1 + 1`がユーザの入力で、Pythonがそれを読み取って解釈し、結果である`2`を返しています。

詳細は後ほど扱いますが、文字を画面に表示させることもできます。

#### コンソール: Pythonシェルで文字列を出力

```python
>>> 'hello' + ' python'
hello python
>>>
```

Pythonのシェルでは、プロンプトを通してPythonと「対話的」にプログラミングを行います。
簡単なプログラムの挙動確認であればPythonシェルを使うことが多いです。
Pythonシェルは「インタプリタ」とも呼ばれます。

Pythonシェルはプログラムのちょっとした挙動確認には便利なのですが、
プログラムの「ソースコード(コード)」を書くためのものではありません。


### プログラムをファイルに書いて実行する

プロンプトの次は「IDLE」と呼ばれるPythonの開発環境を使ってコードを書いてみます。
IDLEは先ほどのようなプロンプト画面も使えますし、Pythonを書くのに適したエディタの機能も持っています。
では、さっそくIDLEを立ち上げてみましょう。

起動すると以下のような画面が立ち上がってきます。
プロンプトと同じなので、計算をさせたり、文字を表示させたりすることもできます。

![image](./0020_image/07.png)

Windowsは、Windows メニューにある「すべてのプログラム」から「Python」を選択し、
その下にある「IDLE (Python GUI)」を選べば起動します。

Macは、アプリケーションフォルダ配下の「Python」ディレクトリの下に「IDLE」がありますので、
それをダブルクリックして起動させます。
パワーシェルやターミナルと同じように、IDLEもタスクバーやDockに登録してしまってもいいかもしれないです。

プロンプトに1行1行書いて実行させるだけでなく、ファイルにPythonのプログラムを書いて実行させることもできます。
IDLEのメニューから［File］ -> ［New File］とすることでエディタが開きます。
これに以下の文を書き込んで「test.py」というファイル名で保存(［File］ -> ［Save］)してください。

Pythonプログラムが書かれたファイルの名前は好きなもので構いませんが、次の条件を満たすものとしてください。

* ファイルの拡張子が「.py」
* アルファベット(小文字推奨)と数字のみから構成されている
* 最初の一文字はアルファベット

拡張子はファイルがPythonのものであることを、ユーザとPython自体に知らせるために必要です。
ファイル名のルールは後ほど扱う「モジュール」という仕組みに関連しています。
今の時点では、深いことは考えずにこの命名規則を守るようにしてください。

以下にIDLEのエディタに書く、サンプルプログラムを記載します。
プログラムの内容は1、2、3と順番に画面に出力させるだけの簡単なものです。

#### プログラム: 1,2,3と出力

```python
print('1')
print('2')
print('3')
```

#### コンソール出力
```text
1
2
3
```

![image](./0020_image/08.png)


IDLEのエディタが選択されている状態で［F5］ボタンを押すと、
このファイルをPythonで実行できます(Macで「F5」を実行するには、［fn］キーを押しながら［F5］ボタンを押す必要があります)。
実行するにはファイルが保存されている必要があります。

F5を押すとプロンプトのウィンドウが前面に来て、プログラムの実行結果が出力されます。

![image](./0020_image/09.png)

なお、先ほど作成したファイル「test.py」を開く際に、利用するアプリケーションとしてIDLEを選択することもできます。
Windows ですと右クリックを押すと「IDLEで編集 (Edit with IDLE)」と出るので、
そこからファイルを直接開けます。
Macだと右クリック(［Control］を押しながらクリック)して、「IDLEで開く」と指定することで実現できます。
もちろん、IDELE のメニューから既存のファイルを開くこともできます。

先程はIDLEからファイルの実行をしましたが、コンソールからpythonのプログラムファイルを実行することも可能です。
Windowsのパワーシェルや、Macのターミナルで「pythonコマンドに続けてファイルを指定する」ことで、
そのファイルに書かれたPythonのプログラムが実行されます。

試しに、先ほどIDLEで作成した「test.py」をターミナルから起動してみます。
IDLEと同じ出力があることからプログラムがきちんと動いていることが分かります。

![image](./0020_image/10.png)

また、プロンプトを見てもらうと分かるように「pythonファイルがあるディレクトリ」に移動してからファイル名を与えてプログラムを実行しています。
違うディレクトリで実行するファイルを指定する場合は、
相対パス(自分がいる場所を起点としたファイルやディレクトリの場所)なり、
絶対パス(ファイルシステムのルートを起点としたファイルの場所)なりを指定する必要があります。

なお、以下のように自分の好きな高機能エディタとターミナルを並べて開発するスタイルや、
PyCharm といった IDE (統合開発環境) を使った開発が現場では一般的です。
IDLEは最初から使えるので便利なのですが、開発に必要な機能がそれほど多くないため、
大規模な開発ではそれほど利用されません。

ある程度コードが書けるようになったら、
自分にあった開発環境を模索してみてもいいかもしれません。

![image](./0020_image/11.png)


### Pythonのプログラムの中で日本語を使う方法

日本人である私達がプログラムを書く場合、日本語を利用する状況は多いはずです。

日本語などのアルファベット文字以外の扱いについては、
後ほど詳細に説明します。
現時点では「UTF-8」という文字コードでプログラムを書けば、
Python3では日本語を使えると覚えておいて下さい。

Windowsでよくつかわれている「Shift-Jis」などは、Python3のデフォルトの文字コードではありません。
特別な宣言なしにShift-Jisを使うと、プログラムが実行できないので注意をしてください。
逆に言えば、宣言をすればShift-Jisの日本語も使えます。


### Pythonコマンドで直接プログラムを実行

この項目はそれほど一般的でないため、初心者のかたは読み飛ばして頂いて構いません。

Pythonでプログラムを実行する方法は、先に説明した「Pythonシェルを使う」ことと、
「Pythonのプログラムファイルを実行する」ことがほとんどです。

ただ、これらに加えて「Pythonコマンドに続けてプログラムを書き、それを実行する」という方法があります。
例えば以下のようなものです。


#### コンソール: Pythonプログラムをコマンドに書いて実行

```text
$ python3 -c "print(1+1)"
2
```

Pythonコマンドに続けて、「-c」オプション、そして実行するプログラムが書かれています。
その実行結果が2となっていることから、「print(1+1)」が実行されていることがわかります。

このように「-c」オプションを使うと、プログラムを直接書いて、実行することができます。

ただ、「-c」に続けて記述するプログラムには、改行を含むことができません。
そのため、プログラムは1行で完結する必要があり、複雑なプログラムを書くには適しません。

利用場面はそれほど多くありませんが、Pythonのプログラムファイルを用意する必要がないため、
以下のような使い方ができます。

* 手順書で「これを実行してください」などと示す
* SSH 経由で他のマシンに処理を実行させる
* シェルのパイプと組み合わせて使う

1行で複雑なプログラムを書くには、高いプログラミングスキルを必要とします。
そのうえ、開発もめんどうなうえに、書かれているプログラムを呼んでも分かりにくいです。
可能であれば、プログラムファイルにプログラムを書き、それを実行するようにしてください。


### Pythonコマンドのオプション

先ほどの「-c」オプションと同じように、pythonコマンドに続けてオプションを付けることで、
特別な動作をさせることができます。

Pythonコマンドのオプションを確認するオプションとして「-h」があります。
どのようなオプションが存在するか現時点で覚える必要はありませんが、
「-h」で「ヘルプ」を確認できることは覚えておいて下さい。

#### コンソール: pythonコマンドのオプション確認

```text
$ python3 -h
usage: /Library/Frameworks/Python.framework/Versions/3.6/Resources/Python.app/Contents/MacOS/Python [option] ... [-c cmd | -m mod | file | -] [arg] ...
Options and arguments (and corresponding environment variables):
-b     : issue warnings about str(bytes_instance), str(bytearray_instance)
         and comparing bytes/bytearray with str. (-bb: issue errors)
-B     : don't write .py[co] files on import; also PYTHONDONTWRITEBYTECODE=x
-c cmd : program passed in as string (terminates option list)
-d     : debug output from parser; also PYTHONDEBUG=x
-E     : ignore PYTHON* environment variables (such as PYTHONPATH)
-h     : print this help message and exit (also --help)
-i     : inspect interactively after running script; forces a prompt even
         if stdin does not appear to be a terminal; also PYTHONINSPECT=x
-I     : isolate Python from the user's environment (implies -E and -s)
-m mod : run library module as a script (terminates option list)
-O     : optimize generated bytecode slightly; also PYTHONOPTIMIZE=x
-OO    : remove doc-strings in addition to the -O optimizations
-q     : don't print version and copyright messages on interactive startup
-s     : don't add user site directory to sys.path; also PYTHONNOUSERSITE
-S     : don't imply 'import site' on initialization
-u     : unbuffered binary stdout and stderr, stdin always buffered;
         also PYTHONUNBUFFERED=x
         see man page for details on internal buffering relating to '-u'
-v     : verbose (trace import statements); also PYTHONVERBOSE=x
         can be supplied multiple times to increase verbosity
-V     : print the Python version number and exit (also --version)
         when given twice, print more information about the build
-W arg : warning control; arg is action:message:category:module:lineno
         also PYTHONWARNINGS=arg
-x     : skip first line of source, allowing use of non-Unix forms of #!cmd
-X opt : set implementation-specific option
file   : program read from script file
-      : program read from stdin (default; interactive mode if a tty)
arg ...: arguments passed to program in sys.argv[1:]

Other environment variables:
PYTHONSTARTUP: file executed on interactive startup (no default)
PYTHONPATH   : ':'-separated list of directories prefixed to the
               default module search path.  The result is sys.path.
PYTHONHOME   : alternate <prefix> directory (or <prefix>:<exec_prefix>).
               The default module search path uses <prefix>/pythonX.X.
PYTHONCASEOK : ignore case in 'import' statements (Windows).
PYTHONIOENCODING: Encoding[:errors] used for stdin/stdout/stderr.
PYTHONFAULTHANDLER: dump the Python traceback on fatal errors.
PYTHONHASHSEED: if this variable is set to 'random', a random value is used
   to seed the hashes of str, bytes and datetime objects.  It can also be
   set to an integer in the range [0,4294967295] to get hash values with a
   predictable seed.
PYTHONMALLOC: set the Python memory allocators and/or install debug hooks
   on Python memory allocators. Use PYTHONMALLOC=debug to install debug
   hooks.
```

## コメント


pythonのプログラムファイルに書かれている内容は、プログラムとして解釈されます。
ただ、プログラムの中にも「プログラムでない文章」を書きたいことがあります。

例えば、複雑なプログラムを書いた際に「この処理はこれこれをしています」といったことを、
プログラムに書いておくという利用法があります。
もし、そういう分かりやすいメッセージがプログラム中に存在していれば、
その複雑なプログラムを呼んだ人が理解しやすくなります。

Pythonに限らず、プログラミング言語はこのような「プログラムとして解釈されないテキスト」を書くことができ、
それを「コメント」と呼んでいます。

### 1行のコメント

以下にPythonのコメントの利用例を記載します。

```python
# 5 + 5 の結果を表示する
print(5 + 5)

print(5 - 3) # 5 - 3 の結果を表示する
```

上記のプログラムでは「# (シャープまたはハッシュと呼ばれる)」が使われています。
この#の後ろからはコメントとしてPythonに解釈されます。
そのため、#より後ろはプログラムとしては無視されます。

1つめの例のようにコメントに1行を割り当てることが一般的です。
ただ、短いコメントであれば2つめのようにPythonの式のあとにコメントを書くこともできます。

このとき、#以降のみがコメントとして扱われるので、#より前はPythonに解釈されて、実行されます。
ちなみに、このような「Pythonのプログラムの後に続けて書かれるコメント」は、「インラインコメント」と呼ばれています。

これらの#から始まるコメントは、それが書かれた1行のみ有効です。

### 複数行のコメント

まとめて複数の行をコメントとして扱うには、以下のようにします。

```python
'''複数行の
コメントも
できる'''
print(5)
```

シングルクオテーションまたはダブルクオテーション3つでテキストを囲むことでそれをコメントとして使うことができます。
このクオテーションを3つ並べた書き方を「トリプルクオテーション」と呼びます。

1行コメントである#を、縦に並べて複数行のコメントを書くこともできますが、
トリプルクオテーションを使うことで、コメントにする手間を減らせます。

なお、トリプルクオテーションは厳密にはコメントではなく、「文字列」を作っています。
文字列ですので、後述する変数や関数で使うことができます。

以下のプログラムがあるとしましょう。

```python
text = '''これは文字列です。
正確にはコメント(プログラムとしては解釈されない)ではありません。
けれども、コメントとして使われます。'''

print(text)
```

これを実行すると、以下のような出力が得られます。

```text
$ python3 test7.py
これは文字列です。
正確にはコメント(プログラムとしては解釈されない)ではありません。
けれども、コメントとして使われます。
```

本シリーズではプログラムの出力をコメントとして表現します。
たとえば以下のプログラムがあるとしましょう。

```python
print(5 + 5)

print(5 - 3)

print(5)
```

これを実行すると以下のような出力が得られます。

```text
$ python3 test.py
10
2
5
```

このとき、本書に記載するコードは以下のように出力をコードにコメントとして埋め込みます。

```python
print(5 + 5)
# 10

print(5 - 3)
# 2

print(5)
# 5
```

また複雑なコードを書く場合も本来の目的でコメントを使います。
自分でコードを書く際も積極的にコメントを書くようにして下さい。
ただ、コメントでわざわざ書かなくてもいい自明のことは書かないようにして下さい。

### 使えないコメント記法

Python以外のプログラミング言語を学ばれてきたかたは、
おそらく以下のようなコメントを利用したのではないでしょうか。

* // : 1行コメント
* /\* \*/ : 複数行コメント

これらはPythonでは使えません。


## エラー(例外)の読み方

今後プログラムを書くにあたり、必ず間違いが発生します。
プログラムに間違いがあった場合に、Pythonは「どこが、どういう理由で間違っている」ということを、
エラーとして出力します。

例えば以下のようなプログラムがあるとしましょう。
プログラムは「test.py」というプログラムファイルに書かれています。

#### プログラム: 2行目に間違いがある

```python
5 + 5
5 ~ 5
5 - 5
```

1行目は足し算、3行目は引き算ですが、2行目に良くわからない記号を使っています。
このような書き方はありません。

このプログラムを実行すると、以下のようなエラー出力が得られます。

#### コンソール: 実行するとエラーが発生

```text
$ python3 test.py
  File "test.py", line 2
    5 ~ 5
      ^
SyntaxError: invalid syntax
```

エラーの出力を上から順に確認すると、以下のことがわかります。

* test.pyというファイルの2行目
* 「5 ~ 5」の「~」
* 「SyntaxError: invalid syntax」というエラーが発生

このようなエラー出力を見て、問題がある箇所を特定して、そこを修正します。

今回のような文法エラー(SyntaxError)ですと、比較的問題箇所がわかりやすいです。
ただ、これ以外にも様々なエラーが存在し、その一部は分かりにくい可能性があります。

エラーの意味が分からない場合はそのエラーの種類をGoogleなどでそのまま検索してください。
必要であればpythonなどのキーワードもつけて下さい。
検索すれば丁寧に説明しているドキュメントやページが表示されるかと思います。

エラーメッセージを読み、間違いを修正するにはある程度の慣れが必要です。
どこでどう間違っているのか、プログラムファイルをしっかり呼んで把握してください。

なお、エラーのことを「例外」と呼ぶ場合もあります。

## 用語

* Python2 : 古いPythonの種類。2.X として様々なバージョンがあるが、2.7が最後
* Python3 : 新しいPythonの種類。3.X として開発中。
* パスを通す
* 環境変数
* コンソール
* パワーシェル(PowerShell)
* ターミナル(Terminal)
* Pythonシェル
* プログラムファイル
* コメント
* \#(ハッシュ、シャープ)
* シングルクオテーション
* ダブルクオテーション
* トリプルクオテーション
* エラー(例外)
